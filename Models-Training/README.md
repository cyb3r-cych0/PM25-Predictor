### ğŸ¤– Model Training â€” PMâ‚‚.â‚… Prediction

This folder contains all **model-specific training scripts** and the **universal model comparison script** for predicting monthly PMâ‚‚.â‚… concentrations using meteorological variables.

Each subfolder represents a distinct model architecture (Random Forest, Gradient Boosting, Lasso, Ridge, and LSTM), allowing modular training, evaluation, and reproducibility.

---

## ğŸ§  Overview

After preparing the aligned dataset (`aligned_monthly_outer_interp.csv` in the `dataset/` folder), the scripts in this directory train multiple predictive models to forecast PMâ‚‚.â‚… levels and generate performance metrics.

Each model folder:
- Uses the same aligned monthly dataset as input
- Trains and evaluates the model
- Saves predictions, evaluation metrics, and trend plots

---

## ğŸ“‚ Folder structure

Models-Training/
â”‚
â”œâ”€â”€ RandomForest-Train/
â”‚ â””â”€â”€ random_forest_train.py
â”‚
â”œâ”€â”€ GradientBoosting-Train/
â”‚ â””â”€â”€ gradient_boosting_train.py
â”‚
â”œâ”€â”€ Lasso-Train/
â”‚ â””â”€â”€ lasso_train.py
â”‚
â”œâ”€â”€ Ridge-Train/
â”‚ â””â”€â”€ ridge_train.py
â”‚
â”œâ”€â”€ LSTM-Train/
â”‚ â””â”€â”€ lstm_train.py
â”‚
â”œâ”€â”€ all_models_comparison.py # Universal script to compare performance
â””â”€â”€ README.md # (This file)

## â–¶ï¸ How to train individual models

Each model is trained independently inside its folder.
Navigate into the modelâ€™s subfolder and run its training script.

# ğŸŸ© Random Forest
- cd RandomForest
- python random_forest_train.py

Output:
- rf_with_lags_model.joblib
- rf_predictions_vs_actual.csv
- rf_feature_importances.csv

Trend and performance plots

# ğŸŸ§ Gradient Boosting
- cd GradientBoosting
- python gradient_boosting_train.py

Output:
- gbr_with_lags_model.joblib
- gbr_with_lags_preds.csv
- Feature importance and trend plots

# ğŸŸ¦ Lasso Regression
- cd Lasso
- python lasso_train.py

Output:

- lasso_with_lags_model.joblib
- lasso_with_lags_preds.csv
- Coefficients and residual trend plots

# ğŸŸª Ridge Regression
- cd Ridge
- python ridge_train.py

Output:
- ridge_with_lags_model.joblib
- ridge_with_lags_preds.csv
- Coefficient table and evaluation summary

# ğŸŸ¥ LSTM (Deep Learning)
- cd LSTM
- python lstm_train.py

Output:
- lstm_pm25_model.h5
- lstm_predictions.csv
- Learning curves and validation loss plots

Note:
The LSTM requires TensorFlow/Keras and uses scaled input features.
Ensure the same scaler (saved during training) is used for prediction or retraining.

# ğŸ“Š Universal model comparison â€” all_models_comparison.py

After training all individual models, return to this folder and run:
- python all_models_comparison.py

This script:
- Loads all trained model outputs
- Compares metrics (RÂ², RMSE, MAE)
- Compiles trend and bias slopes
- Generates a combined performance table and visualization

Output includes:
- combined_model_metrics.csv
- combined_model_trend_summary.csv
- combined_model_performance_plot.png (bar chart or scatter comparing model accuracy)
- combined_model_bias_plot.png (visualizes bias trends)

## ğŸ§® Typical model performance (example)

Model	RÂ²	RMSE	MAE	Trend Bias (ÂµgÂ·mâ»Â³Â·yrâ»Â¹)
Random Forest	0.625	2.876	2.105	+0.25
Gradient Boosting	0.569	3.084	2.406	+0.56
Lasso	0.569	3.082	2.325	+0.12
Ridge	0.560	3.114	2.346	+0.15
LSTM	0.627	2.832	2.030	+0.09

# ğŸ“ˆ Visualization examples

Per-model trend plots: located in actual_vs_pred_trends/
Combined summary plot: generated by all_models_comparison.py

## ğŸ’¡ Notes & tips

All models use the same aligned dataset for fairness.
Trend computation uses ordinary least squares on monthly series.
Models can be retrained anytime â€” just re-run the specific script.

## ğŸ§  Recommended workflow
# Step 1 â€” Prepare data
- cd dataset
- python align_to_monthly.py

# Step 2 â€” Train models
- cd ../models-training
- python RandomForest/random_forest_train.py
- python GradientBoosting/gradient_boosting_train.py
- python Lasso/lasso_train.py
- python Ridge/ridge_train.py
- python LSTM/lstm_train.py

# Step 3 â€” Compare models
- python all_models_comparison.py